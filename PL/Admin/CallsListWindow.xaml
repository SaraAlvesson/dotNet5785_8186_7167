<Window x:Class="PL.Admin.CallsListWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Manage Calls" Height="600" Width="900" DataContext="{Binding RelativeSource={RelativeSource Self}}">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- סינון ומיון -->
        <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,10">
            <TextBlock Text="Filter by:" VerticalAlignment="Center" Margin="0,0,5,0" />
            <ComboBox Width="150" SelectedItem="{Binding SelectedFilterField}" Margin="0,0,10,0">
                <ComboBoxItem Content="Call Id" Tag="Id" />
                <ComboBoxItem Content="Status" Tag="Status" />
                <ComboBoxItem Content="Last Volunteer" Tag="LastVolunteer" />
            </ComboBox>
            <TextBox Width="200" Text="{Binding FilterValue}" Margin="0,0,10,0" />
            <Button Content="Apply Filter" Background="#2196F3" Foreground="White" Padding="5,2" />
        </StackPanel>

        <!-- רשימת הקריאות -->
        <ListView Grid.Row="1" Margin="0,10,0,10" ItemsSource="{Binding FilteredCallList}" 
                  SelectedItem="{Binding SelectedCall}" MouseDoubleClick="lsvCallList_MouseDoubleClick">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Call Id" DisplayMemberBinding="{Binding Id}" Width="70" />
                    <GridViewColumn Header="Call Type" DisplayMemberBinding="{Binding Type}" Width="100" />
                    <GridViewColumn Header="Status" DisplayMemberBinding="{Binding Status}" Width="100" />
                    <GridViewColumn Header="Time Remaining" DisplayMemberBinding="{Binding TimeRemaining}" Width="150" />
                    <GridViewColumn Header="Treatment Time" DisplayMemberBinding="{Binding TreatmentTime}" Width="150" />
                    <GridViewColumn Header="Last Volunteer" DisplayMemberBinding="{Binding LastVolunteer}" Width="150" />
                    <GridViewColumn Header="Total Assignments" DisplayMemberBinding="{Binding TotalAssignments}" Width="150" />
                    <GridViewColumn Header="Actions" Width="120">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <!-- כפתור מחיקה -->
                                    <Button Content="Delete" Width="60" Margin="0,0,5,0"
                                            Visibility="{Binding IsDeleteButtonVisible}" Command="{Binding DeleteCommand}" />
                                    <!-- כפתור ביטול הקצאה -->
                                    <Button Content="Unassign" Width="70"
                                            Visibility="{Binding IsUnassignButtonVisible}" Command="{Binding UnassignCommand}" />
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- כפתור הוספה -->
        <Button Grid.Row="2" Content="Add Call" HorizontalAlignment="Center" Width="150" Height="40"
                Click="ButtonAdd_Click" Background="#4CAF50" Foreground="White" FontWeight="Bold" BorderThickness="0" />
    </Grid>
</Window>
